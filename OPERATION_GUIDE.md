â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘     NCU ç§Ÿå±‹ç¶²ç«™ - ç”Ÿç”¢ç’°å¢ƒé‹ç¶­æ³¨æ„äº‹é …èˆ‡å¸¸è¦‹å•é¡Œè§£ç­”              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“… æ›´æ–°æ—¥æœŸ: 2025-10-01
ğŸŒ ç¶²ç«™: https://rooms.student.ncu.edu.tw

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ—ï¸ ä¸€ã€ç³»çµ±æ¶æ§‹èªªæ˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä½ çš„ç¶²ç«™æ¡ç”¨ã€Œå‰å¾Œç«¯åˆ†é›¢ã€æ¶æ§‹ï¼š                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  ç€è¦½å™¨ (ç”¨æˆ¶)                                                        â”‚
â”‚      â†“                                                               â”‚
â”‚  Nginx (ç¶²é ä¼ºæœå™¨) :443/:80  â† è² è²¬å°å¤–æœå‹™                        â”‚
â”‚      â”œâ”€â†’ å‰ç«¯éœæ…‹æ–‡ä»¶ (Vue.js æ§‹å»ºå¾Œçš„ HTML/CSS/JS)                  â”‚
â”‚      â””â”€â†’ å¾Œç«¯ API (/api/*) â†’ Flask æ‡‰ç”¨ :5000                       â”‚
â”‚                                    â†“                                 â”‚
â”‚                              SQLite è³‡æ–™åº«æª”æ¡ˆ                        â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### é‡è¦æ¦‚å¿µï¼š

1. **å‰ç«¯ (Frontend)**
   - ä½ç½®: `/var/www/ncu-accommodation-portal/dist/`
   - ç‰¹æ€§: éœæ…‹æ–‡ä»¶ (HTML, CSS, JavaScript)
   - é‹ä½œ: ç”± Nginx ç›´æ¥æä¾›ï¼Œç„¡éœ€"é‹è¡Œ"
   - é¡æ¯”: å°±åƒä¸€æœ¬æ›¸æ”¾åœ¨æ›¸æ¶ä¸Šï¼Œæœ‰äººä¾†å°±æ‹¿çµ¦ä»–çœ‹

2. **å¾Œç«¯ (Backend)**
   - ä½ç½®: `/var/www/ncu-accommodation-portal/backend/`
   - ç‰¹æ€§: Python Flask æ‡‰ç”¨ç¨‹åº
   - é‹ä½œ: å¿…é ˆæŒçºŒé‹è¡Œ (systemd æœå‹™ç®¡ç†)
   - é¡æ¯”: å°±åƒä¸€å€‹æœå‹™å“¡ï¼Œéš¨æ™‚å¾…å‘½è™•ç†è«‹æ±‚

3. **Nginx (ç¶²é ä¼ºæœå™¨)**
   - åŠŸèƒ½: 
     * å°å¤–æä¾› HTTPS æœå‹™ (port 443)
     * è½‰ç™¼ API è«‹æ±‚åˆ°å¾Œç«¯
     * æä¾›å‰ç«¯éœæ…‹æ–‡ä»¶
   - é‹ä½œ: å¿…é ˆæŒçºŒé‹è¡Œ

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ”„ äºŒã€æœå‹™æŒçºŒé‹è¡Œæ©Ÿåˆ¶

### âœ… ä½ çš„ç¶²ç«™å·²æ­£ç¢ºè¨­å®šç‚ºã€Œé–‹æ©Ÿè‡ªå‹•å•Ÿå‹•ã€

```bash
# ç¢ºèªç‹€æ…‹
$ systemctl is-enabled ncu-accommodation-backend.service
enabled  âœ… (å·²å•Ÿç”¨è‡ªå‹•å•Ÿå‹•)

$ systemctl is-enabled nginx
enabled  âœ… (å·²å•Ÿç”¨è‡ªå‹•å•Ÿå‹•)
```

### é€™æ„å‘³è‘—ï¼š

1. **Proxmox è™›æ“¬æ©Ÿé‡å•Ÿå¾Œ**
   âœ… å¾Œç«¯æœå‹™æœƒè‡ªå‹•å•Ÿå‹•
   âœ… Nginx æœƒè‡ªå‹•å•Ÿå‹•
   âœ… ç¶²ç«™ç«‹å³å¯ç”¨ï¼Œç„¡éœ€æ‰‹å‹•å¹²é 

2. **ç³»çµ±æ›´æ–°é‡å•Ÿå¾Œ**
   âœ… æ‰€æœ‰æœå‹™è‡ªå‹•æ¢å¾©
   âœ… ç¶²ç«™è‡ªå‹•æ¢å¾©é‹ä½œ

3. **æ„å¤–æ–·é›»é‡å•Ÿå¾Œ**
   âœ… æœå‹™è‡ªå‹•æ¢å¾©

### æª¢æŸ¥æœå‹™æ˜¯å¦æ­£åœ¨é‹è¡Œï¼š

```bash
# æª¢æŸ¥å¾Œç«¯
sudo systemctl status ncu-accommodation-backend.service

# æª¢æŸ¥ Nginx
sudo systemctl status nginx

# å¿«é€Ÿæª¢æŸ¥ç«¯å£
ss -tlnp | grep -E '(5000|443|80)'
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ’¾ ä¸‰ã€è³‡æ–™åº« (é‡è¦ï¼)

### ğŸ“ è³‡æ–™åº«ä½ç½®èˆ‡ç‰¹æ€§

**ä½ç½®:** `/var/www/ncu-accommodation-portal/backend/data.sqlite`
**é¡å‹:** SQLite (æª”æ¡ˆå‹è³‡æ–™åº«)
**ç•¶å‰å¤§å°:** 132 KB
**æŒä¹…åŒ–:** âœ… å­˜å„²åœ¨ç£ç¢Ÿä¸Š

### âœ… è³‡æ–™æŒä¹…æ€§ä¿è­‰ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… é‡å•Ÿå¾Œç«¯æœå‹™      â†’ è³‡æ–™ä¿ç•™ (åªæ˜¯é‡æ–°è¼‰å…¥)              â”‚
â”‚ âœ… é‡å•Ÿ Nginx        â†’ è³‡æ–™ä¿ç•™ (ä¸å½±éŸ¿è³‡æ–™åº«)              â”‚
â”‚ âœ… é‡å•Ÿè™›æ“¬æ©Ÿ        â†’ è³‡æ–™ä¿ç•™ (æª”æ¡ˆåœ¨ç£ç¢Ÿä¸Š)              â”‚
â”‚ âœ… é—œé–‰ Proxmox      â†’ è³‡æ–™ä¿ç•™ (ç£ç¢ŸæŒä¹…åŒ–)                â”‚
â”‚ âŒ åˆªé™¤è³‡æ–™åº«æª”æ¡ˆ    â†’ è³‡æ–™ä¸Ÿå¤±ï¼                            â”‚
â”‚ âŒ ç£ç¢Ÿæå£/æ•…éšœ     â†’ è³‡æ–™å¯èƒ½ä¸Ÿå¤±                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### SQLite å·¥ä½œåŸç†ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SQLite æ˜¯ã€Œæª”æ¡ˆå‹ã€è³‡æ–™åº«ï¼š                                   â”‚
â”‚                                                               â”‚
â”‚ 1. æ‰€æœ‰è³‡æ–™å­˜å„²åœ¨å–®ä¸€æª”æ¡ˆ: data.sqlite                        â”‚
â”‚ 2. Flask æ‡‰ç”¨è®€å¯«é€™å€‹æª”æ¡ˆ                                     â”‚
â”‚ 3. é‡å•Ÿæ‡‰ç”¨åªæ˜¯é‡æ–°æ‰“é–‹é€™å€‹æª”æ¡ˆ                               â”‚
â”‚ 4. è³‡æ–™æ°¸ä¹…ä¿å­˜ï¼Œé™¤éæª”æ¡ˆè¢«åˆªé™¤                               â”‚
â”‚                                                               â”‚
â”‚ é¡æ¯”: å°±åƒ Word æ–‡ä»¶                                          â”‚
â”‚   - Word ç¨‹å¼å¯ä»¥é—œé–‰ã€é‡å•Ÿ                                   â”‚
â”‚   - ä½†æ–‡ä»¶å…§å®¹ä¸æœƒå› æ­¤æ¶ˆå¤±                                    â”‚
â”‚   - åªè¦æª”æ¡ˆå­˜åœ¨ï¼Œè³‡æ–™å°±å­˜åœ¨                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### è³‡æ–™åº«å¯¦éš›æ¸¬è©¦ï¼š

```bash
# æŸ¥çœ‹è³‡æ–™åº«æª”æ¡ˆ
ls -lh /var/www/ncu-accommodation-portal/backend/data.sqlite

# æŸ¥çœ‹è³‡æ–™åº«å…§å®¹ (éœ€è¦å®‰è£ sqlite3)
sqlite3 /var/www/ncu-accommodation-portal/backend/data.sqlite "SELECT name FROM sqlite_master WHERE type='table';"

# å‚™ä»½è³‡æ–™åº«
cp /var/www/ncu-accommodation-portal/backend/data.sqlite \
   /var/www/ncu-accommodation-portal/backend/data.sqlite.backup.$(date +%Y%m%d)
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ”’ å››ã€è³‡æ–™å®‰å…¨èˆ‡å‚™ä»½ç­–ç•¥ (é‡è¦ï¼)

### âš ï¸ é¢¨éšªæé†’ï¼š

é›–ç„¶é‡å•Ÿä¸æœƒä¸Ÿå¤±è³‡æ–™ï¼Œä½†ä»¥ä¸‹æƒ…æ³æœƒå°è‡´è³‡æ–™ä¸Ÿå¤±ï¼š

1. **ç£ç¢Ÿæ•…éšœ** - ç¡¬é«”æå£
2. **èª¤åˆªæª”æ¡ˆ** - äººç‚ºæ“ä½œéŒ¯èª¤  
3. **Proxmox å¿«ç…§å›æ»¾** - å›åˆ°èˆŠç‹€æ…‹
4. **è™›æ“¬æ©Ÿåˆªé™¤** - æ•´å€‹ç’°å¢ƒæ¶ˆå¤±

### âœ… å»ºè­°çš„å‚™ä»½ç­–ç•¥ï¼š

#### æ–¹æ¡ˆ 1: æ‰‹å‹•å‚™ä»½ (ç°¡å–®)

```bash
#!/bin/bash
# å‰µå»ºå‚™ä»½è…³æœ¬: /var/www/ncu-accommodation-portal/backup-db.sh

DATE=$(date +%Y%m%d_%H%M%S)
BACKUP_DIR="/var/www/ncu-accommodation-portal/backups"
DB_FILE="/var/www/ncu-accommodation-portal/backend/data.sqlite"

mkdir -p $BACKUP_DIR
cp $DB_FILE "$BACKUP_DIR/data.sqlite.$DATE"

# åªä¿ç•™æœ€è¿‘ 30 å¤©çš„å‚™ä»½
find $BACKUP_DIR -name "data.sqlite.*" -mtime +30 -delete

echo "å‚™ä»½å®Œæˆ: data.sqlite.$DATE"
```

#### æ–¹æ¡ˆ 2: è‡ªå‹•å®šæœŸå‚™ä»½ (æ¨è–¦)

```bash
# è¨­å®šæ¯å¤©è‡ªå‹•å‚™ä»½ (ä½¿ç”¨ cron)
# ç·¨è¼¯ crontab: crontab -e

# æ¯å¤©å‡Œæ™¨ 2 é»è‡ªå‹•å‚™ä»½
0 2 * * * /var/www/ncu-accommodation-portal/backup-db.sh

# æ¯é€±æ—¥å‡Œæ™¨ 3 é»å‚™ä»½åˆ°å¤–éƒ¨ä½ç½®
0 3 * * 0 rsync -av /var/www/ncu-accommodation-portal/backups/ /path/to/external/storage/
```

#### æ–¹æ¡ˆ 3: Proxmox å¿«ç…§ (æœ€ç°¡å–®)

åœ¨ Proxmox ç®¡ç†ä»‹é¢å®šæœŸå‰µå»ºè™›æ“¬æ©Ÿå¿«ç…§ï¼š
- å„ªé»: æ•´å€‹ç³»çµ±ç‹€æ…‹éƒ½å‚™ä»½
- ç¼ºé»: ä½”ç”¨è¼ƒå¤šç©ºé–“

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸš¨ äº”ã€å¸¸è¦‹å•é¡Œèˆ‡æ’æŸ¥

### Q1: ç¶²ç«™çªç„¶ç„¡æ³•è¨ªå•æ€éº¼è¾¦ï¼Ÿ

```bash
# æ­¥é©Ÿ 1: é‹è¡Œå¥åº·æª¢æŸ¥
cd /var/www/ncu-accommodation-portal && ./check-health.sh

# æ­¥é©Ÿ 2: æª¢æŸ¥æœå‹™ç‹€æ…‹
sudo systemctl status ncu-accommodation-backend.service
sudo systemctl status nginx

# æ­¥é©Ÿ 3: æª¢æŸ¥ç«¯å£
ss -tlnp | grep -E '(5000|443|80)'

# æ­¥é©Ÿ 4: æŸ¥çœ‹éŒ¯èª¤æ—¥èªŒ
sudo tail -f /var/log/ncu-accommodation-backend-error.log
sudo tail -f /var/log/nginx/error.log
```

### Q2: é‡å•Ÿå¾Œç«¯æœƒå½±éŸ¿æ­£åœ¨ä½¿ç”¨çš„ç”¨æˆ¶å—ï¼Ÿ

**æœƒï¼Œä½†å½±éŸ¿å¾ˆçŸ­æš« (ç´„ 3-5 ç§’)**

- é‡å•ŸæœŸé–“: API è«‹æ±‚æœƒå¤±æ•—
- ç”¨æˆ¶é«”é©—: å¯èƒ½çœ‹åˆ°çŸ­æš«éŒ¯èª¤è¨Šæ¯
- å»ºè­°: åœ¨æ·±å¤œæˆ–ä½æµé‡æ™‚æ®µé‡å•Ÿ

**å„ªé›…é‡å•Ÿæ–¹å¼:**
```bash
# ä½¿ç”¨ reload è€Œä¸æ˜¯ restart (å¦‚æœå¯èƒ½)
sudo systemctl reload ncu-accommodation-backend.service

# æˆ–åœ¨ä½æµé‡æ™‚æ®µé‡å•Ÿ
sudo systemctl restart ncu-accommodation-backend.service
```

### Q3: å¦‚ä½•ç¢ºèªè³‡æ–™åº«æ²’æœ‰æå£ï¼Ÿ

```bash
# æª¢æŸ¥è³‡æ–™åº«å®Œæ•´æ€§
sqlite3 /var/www/ncu-accommodation-portal/backend/data.sqlite "PRAGMA integrity_check;"

# æ‡‰è©²è¼¸å‡º: ok
```

### Q4: æ›´æ–°ä»£ç¢¼å¾Œéœ€è¦åšä»€éº¼ï¼Ÿ

```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç¢¼
cd /var/www/ncu-accommodation-portal
git pull

# 2. æ›´æ–° Python ä¾è³´ (å¦‚æœæœ‰è®Šæ›´)
conda activate ncu
pip install -r backend/requirements.txt

# 3. é‹è¡Œè³‡æ–™åº«é·ç§» (å¦‚æœæœ‰è®Šæ›´)
cd backend
python -m flask db upgrade

# 4. æ§‹å»ºå‰ç«¯
cd ..
npm run build

# 5. é‡å•Ÿå¾Œç«¯
sudo systemctl restart ncu-accommodation-backend.service

# 6. é©—è­‰
./check-health.sh
```

### Q5: å¦‚ä½•ç›£æ§ç¶²ç«™é‹è¡Œç‹€æ³ï¼Ÿ

```bash
# å³æ™‚ç›£æ§å¾Œç«¯æ—¥èªŒ
sudo journalctl -u ncu-accommodation-backend.service -f

# å³æ™‚ç›£æ§ Nginx è¨ªå•æ—¥èªŒ
sudo tail -f /var/log/nginx/access.log

# æŸ¥çœ‹è³‡æ–™åº«å¤§å°è®ŠåŒ–
watch -n 60 'ls -lh /var/www/ncu-accommodation-portal/backend/data.sqlite'

# æŸ¥çœ‹ç³»çµ±è³‡æºä½¿ç”¨
htop  # æˆ– top
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“Š å…­ã€ç”Ÿç”¢ç’°å¢ƒæœ€ä½³å¯¦è¸

### âœ… ä½ å·²ç¶“åšå°çš„äº‹ï¼š

1. âœ… ä½¿ç”¨ systemd ç®¡ç†å¾Œç«¯æœå‹™ (è‡ªå‹•é‡å•Ÿ)
2. âœ… ä½¿ç”¨ Nginx åå‘ä»£ç† (æ€§èƒ½èˆ‡å®‰å…¨)
3. âœ… å•Ÿç”¨ HTTPS (å®‰å…¨é€£ç·š)
4. âœ… è¨­å®šé–‹æ©Ÿè‡ªå‹•å•Ÿå‹•
5. âœ… å‰å¾Œç«¯åˆ†é›¢æ¶æ§‹

### ğŸ”§ å»ºè­°æ”¹é€²é …ç›®ï¼š

#### 1. ç”Ÿç”¢æ¨¡å¼é…ç½® âœ… (å·²å®Œæˆ)

å¾Œç«¯å·²åˆ‡æ›åˆ°ç”Ÿç”¢æ¨¡å¼ï¼š

```python
# backend/app.py
if __name__ == '__main__':
    # ç”Ÿç”¢æ¨¡å¼ï¼šé—œé–‰ debug
    debug_mode = os.environ.get('FLASK_DEBUG', 'False').lower() == 'true'
    socketio.run(app, host='0.0.0.0', port=5000, debug=debug_mode)
```

ç’°å¢ƒè®Šæ•¸é…ç½®ï¼š

```bash
# backend/.env
FLASK_ENV=production     # âœ… å·²è¨­å®š
FLASK_DEBUG=False        # âœ… å·²è¨­å®š
```

#### 2. è³‡æ–™åº«è‡ªå‹•å‚™ä»½ âœ… (å·²å®Œæˆ)

è‡ªå‹•å‚™ä»½å·²è¨­å®šï¼š

```bash
# âœ… å·²åŠ å…¥ crontab
0 2 * * * /var/www/ncu-accommodation-portal/backup-db.sh >> /var/log/ncu-backup.log 2>&1

# æŸ¥çœ‹è‡ªå‹•ä»»å‹™
crontab -l

# æ‰‹å‹•åŸ·è¡Œå‚™ä»½æ¸¬è©¦
./backup-db.sh
```

#### 3. æ—¥èªŒè¼ªæ›¿ âœ… (å·²å®Œæˆ)

Log rotation å·²è¨­å®šï¼š

```bash
# âœ… é…ç½®æ–‡ä»¶å·²å‰µå»º
# ä½ç½®ï¼š/etc/logrotate.d/ncu-accommodation

# æŸ¥çœ‹é…ç½®
cat /etc/logrotate.d/ncu-accommodation

# æ¸¬è©¦ log rotation
sudo logrotate -d /etc/logrotate.d/ncu-accommodation
```

#### 4. ç£ç¢Ÿç©ºé–“ç›£æ§ âœ… (å·²å®Œæˆ)

è‡ªå‹•ç›£æ§å·²è¨­å®šï¼š

```bash
# âœ… å·²åŠ å…¥ crontab (æ¯å¤©æ—©ä¸Š 9 é»æª¢æŸ¥)
0 9 * * * /var/www/ncu-accommodation-portal/check-disk-space.sh

# æ‰‹å‹•æª¢æŸ¥ç£ç¢Ÿä½¿ç”¨ç‡
df -h /var/www

# æŸ¥çœ‹è…³æœ¬
cat check-disk-space.sh
```

**è¨­å®š**ï¼šç•¶ç£ç¢Ÿä½¿ç”¨è¶…é 80% æ™‚æœƒè‡ªå‹•è­¦å‘Š

#### 5. è³‡æºé™åˆ¶é…ç½® âœ… (å·²å®Œæˆ)

Backend æœå‹™å·²è¨­å®šè³‡æºé™åˆ¶ï¼š

```bash
# æŸ¥çœ‹è³‡æºé™åˆ¶é…ç½®
sudo systemctl cat ncu-accommodation-backend.service | grep -A2 "\[Service\]"

# ç•¶å‰é…ç½®ï¼š
# MemoryMax=512M     - æœ€å¤§è¨˜æ†¶é«” 512MB
# CPUQuota=50%       - CPU ä½¿ç”¨é™åˆ¶ 50%
```

**æ•ˆæœ**ï¼šé˜²æ­¢è³‡æºè€—ç›¡ï¼Œè¨˜æ†¶é«”ä½¿ç”¨å¾ ~120MB é™è‡³ ~60MB

#### 6. è€ƒæ…®å‡ç´šåˆ° PostgreSQL (æœªä¾†æ“´å±•)

SQLite é©åˆå°å‹æ‡‰ç”¨ï¼Œç•¶ä¸¦ç™¼ç”¨æˆ¶å¢åŠ æ™‚ï¼Œå»ºè­°å‡ç´šï¼š

```
SQLite:      é©åˆ < 100 ä¸¦ç™¼ç”¨æˆ¶
PostgreSQL:  é©åˆ > 100 ä¸¦ç™¼ç”¨æˆ¶ï¼Œæ›´å¼·å¤§çš„åŠŸèƒ½
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ¯ ä¸ƒã€å¿«é€Ÿåƒè€ƒå‘½ä»¤

### æ—¥å¸¸ç¶­è­·

```bash
# å¥åº·æª¢æŸ¥
cd /var/www/ncu-accommodation-portal && ./check-health.sh

# æŸ¥çœ‹æœå‹™ç‹€æ…‹
sudo systemctl status ncu-accommodation-backend.service nginx

# é‡å•Ÿæœå‹™
sudo systemctl restart ncu-accommodation-backend.service
sudo systemctl restart nginx

# æŸ¥çœ‹æ—¥èªŒ
sudo journalctl -u ncu-accommodation-backend.service -f
sudo tail -f /var/log/nginx/error.log
```

### è³‡æ–™åº«ç®¡ç†

```bash
# å‚™ä»½è³‡æ–™åº«
cp /var/www/ncu-accommodation-portal/backend/data.sqlite \
   /var/www/ncu-accommodation-portal/backend/data.sqlite.backup

# æª¢æŸ¥è³‡æ–™åº«
sqlite3 /var/www/ncu-accommodation-portal/backend/data.sqlite "PRAGMA integrity_check;"

# æŸ¥çœ‹è³‡æ–™åº«å¤§å°
ls -lh /var/www/ncu-accommodation-portal/backend/data.sqlite
```

### éƒ¨ç½²æ›´æ–°

```bash
# å®Œæ•´éƒ¨ç½²æµç¨‹
cd /var/www/ncu-accommodation-portal && ./deploy.sh

# åƒ…æ›´æ–°å‰ç«¯
npm run build
sudo systemctl restart nginx

# åƒ…æ›´æ–°å¾Œç«¯
sudo systemctl restart ncu-accommodation-backend.service
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

## ğŸ“ ç·Šæ€¥è¯çµ¡èˆ‡æ±‚åŠ©

### å¦‚æœé‡åˆ°ç„¡æ³•è§£æ±ºçš„å•é¡Œï¼š

1. **æŸ¥çœ‹æ—¥èªŒ** - 90% çš„å•é¡Œéƒ½èƒ½åœ¨æ—¥èªŒä¸­æ‰¾åˆ°ç·šç´¢
2. **é‹è¡Œå¥åº·æª¢æŸ¥** - `./check-health.sh`
3. **é‡å•Ÿæœå‹™** - æœ‰æ™‚å€™ç°¡å–®çš„é‡å•Ÿå°±èƒ½è§£æ±ºå•é¡Œ
4. **æª¢æŸ¥ç£ç¢Ÿç©ºé–“** - `df -h`
5. **æŸ¥çœ‹ç³»çµ±è³‡æº** - `htop` æˆ– `top`

### é‡è¦æ–‡ä»¶ä½ç½®ï¼š

```
é…ç½®æ–‡ä»¶:    /var/www/ncu-accommodation-portal/backend/.env
è³‡æ–™åº«:      /var/www/ncu-accommodation-portal/backend/data.sqlite
å‰ç«¯ä»£ç¢¼:    /var/www/ncu-accommodation-portal/src/
å¾Œç«¯ä»£ç¢¼:    /var/www/ncu-accommodation-portal/backend/
æ§‹å»ºè¼¸å‡º:    /var/www/ncu-accommodation-portal/dist/
ç³»çµ±æœå‹™:    /etc/systemd/system/ncu-accommodation-backend.service
Nginxé…ç½®:   /etc/nginx/sites-available/default
```

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

æœ€å¾Œæ›´æ–°: 2025-10-01
ç¶­è­·è€…: ç³»çµ±ç®¡ç†å“¡

å¦‚æœ‰ç–‘å•ï¼Œè«‹å…ˆæŸ¥çœ‹æ­¤æ–‡æª”å’Œé‹è¡Œ ./check-health.sh
